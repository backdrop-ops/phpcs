<?xml version="1.0"?>
<ruleset name="Backdrop">
  <description>Coding standards for Backdrop CMS.</description>
  <arg name="encoding" value="utf-8" />
  <arg name="extensions" value="php,inc,module,install,profile,engine,test" />

  <!-- Include sniffs from the Generic standard. -->
  <rule ref="Generic">
    <properties>
      <!-- We use 2-space indentation. -->
      <property name="indent" value="2" />
    </properties>

    <!-- Exclude sniffs that don't match our coding standards. -->
    <exclude name="Generic.Arrays.ArrayIndent.OpenBraceIncorrect" />
    <exclude name="Generic.Arrays.DisallowLongArraySyntax" />
    <exclude name="Generic.CodeAnalysis.AssignmentInCondition" />
    <exclude name="Generic.CodeAnalysis.EmptyStatement" />
    <exclude name="Generic.CodeAnalysis.ForLoopWithTestFunctionCall" />
    <exclude name="Generic.Commenting.DocComment.LongNotCapital" />
    <exclude name="Generic.Commenting.DocComment.MissingShort" />
    <exclude name="Generic.Commenting.DocComment.NonParamGroup" />
    <exclude name="Generic.Commenting.DocComment.ParamNotFirst" />
    <exclude name="Generic.Commenting.DocComment.SpacingBeforeTags" />
    <exclude name="Generic.Commenting.DocComment.TagsNotGrouped" />
    <exclude name="Generic.Commenting.DocComment.TagValueIndent" />
    <exclude name="Generic.Commenting.Todo" />
    <exclude name="Generic.ControlStructures.InlineControlStructure" />
    <exclude name="Generic.Files.EndFileNoNewline" />
    <exclude name="Generic.Files.LineLength" />
    <exclude name="Generic.Files.LowercasedFilename" />
    <exclude name="Generic.Files.OneClassPerFile" />
    <exclude name="Generic.Files.OneInterfacePerFile" />
    <exclude name="Generic.Files.OneObjectStructurePerFile" />
    <exclude name="Generic.Formatting.MultipleStatementAlignment" />
    <exclude name="Generic.Formatting.NoSpaceAfterCast" />
    <exclude name="Generic.Formatting.SpaceAfterNot" />
    <exclude name="Generic.Formatting.SpaceBeforeCast" />
    <exclude name="Generic.Functions.FunctionCallArgumentSpacing.SpaceBeforeComma" />
    <exclude name="Generic.Functions.OpeningFunctionBraceBsdAllman" />
    <exclude name="Generic.Metrics" />
    <exclude name="Generic.NamingConventions.AbstractClassNamePrefix" />
    <exclude name="Generic.NamingConventions.CamelCapsFunctionName" />
    <exclude name="Generic.PHP.ClosingPHPTag" />
    <exclude name="Generic.PHP.DisallowRequestSuperglobal" />
    <exclude name="Generic.PHP.ForbiddenFunctions" />
    <exclude name="Generic.PHP.LowerCaseConstant" />
    <exclude name="Generic.PHP.LowerCaseKeyword" />
    <exclude name="Generic.PHP.NoSilencedErrors" />
    <exclude name="Generic.PHP.RequireStrictTypes" />
    <exclude name="Generic.PHP.SAPIUsage" />
    <exclude name="Generic.Strings.UnnecessaryStringConcat" />
    <exclude name="Generic.WhiteSpace.ArbitraryParenthesesSpacing.SpaceAfterOpen" />
    <exclude name="Generic.WhiteSpace.ArbitraryParenthesesSpacing.SpaceBeforeClose" />
    <exclude name="Generic.WhiteSpace.DisallowSpaceIndent" />
  </rule>

  <!-- Exclude files/folders from certain sniffs. -->
  <rule ref="Generic.Files.InlineHTML">
    <!-- Template files are allowed to use inline HTML. -->
    <exclude-pattern>*.tpl.php</exclude-pattern>
  </rule>
  <rule ref="Generic.PHP.CharacterBeforePHPOpeningTag">
    <!-- Template files can have HTML before the first PHP tag. -->
    <exclude-pattern>*.tpl.php</exclude-pattern>
  </rule>
  <rule ref="Internal.NoCodeFound">
    <!-- Template files are allowed to be empty (mainly for testing). -->
    <exclude-pattern>*.tpl.php</exclude-pattern>
  </rule>

  <!-- Include sniffs from the Squiz standard. -->
  <rule ref="Squiz">
    <properties>
      <!-- We use 2-space indentation. -->
      <property name="indent" value="2" />
    </properties>

    <!-- Exclude sniffs that don't match our coding standards. -->
    <exclude name="PEAR.ControlStructures.MultiLineCondition" />
    <exclude name="PEAR.Formatting.MultiLineAssignment.EqualSignLine" />
    <exclude name="PEAR.Functions.FunctionCallSignature.CloseBracketLine" />
    <exclude name="PEAR.Functions.FunctionCallSignature.ContentAfterOpenBracket" />
    <exclude name="PEAR.Functions.FunctionCallSignature.Indent" />
    <exclude name="Squiz.Arrays.ArrayDeclaration.DoubleArrowNotAligned" />
    <exclude name="Squiz.Arrays.ArrayDeclaration.KeySpecified" />
    <exclude name="Squiz.Classes.ClassDeclaration.MultipleClasses" />
    <exclude name="Squiz.Classes.ClassDeclaration.OpenBraceNewLine" />
    <exclude name="Squiz.Classes.ClassFileName" />
    <exclude name="Squiz.Classes.ValidClassName.NotCamelCaps" />
    <exclude name="Squiz.Commenting.BlockComment.NoEmptyLineAfter" />
    <exclude name="Squiz.Commenting.BlockComment.WrongStart" />
    <exclude name="Squiz.Commenting.ClassComment.TagNotAllowed" />
    <exclude name="Squiz.Commenting.ClosingDeclarationComment" />
    <exclude name="Squiz.Commenting.DocCommentAlignment.SpaceAfterStar" />
    <exclude name="Squiz.Commenting.FileComment.AuthorTagOrder" />
    <exclude name="Squiz.Commenting.FileComment.CopyrightTagOrder" />
    <exclude name="Squiz.Commenting.FileComment.MissingAuthorTag" />
    <exclude name="Squiz.Commenting.FileComment.MissingCopyrightTag" />
    <exclude name="Squiz.Commenting.FileComment.MissingPackageTag" />
    <exclude name="Squiz.Commenting.FileComment.MissingSubpackageTag" />
    <exclude name="Squiz.Commenting.FileComment.PackageTagOrder" />
    <exclude name="Squiz.Commenting.FileComment.SubpackageTagOrder" />
    <exclude name="Squiz.Commenting.FunctionComment.EmptyThrows" />
    <exclude name="Squiz.Commenting.FunctionComment.IncorrectParamVarName" />
    <exclude name="Squiz.Commenting.FunctionComment.IncorrectTypeHint" />
    <exclude name="Squiz.Commenting.FunctionComment.InvalidReturn" />
    <exclude name="Squiz.Commenting.FunctionComment.MissingParamComment" />
    <exclude name="Squiz.Commenting.FunctionComment.MissingParamName" />
    <exclude name="Squiz.Commenting.FunctionComment.MissingParamTag" />
    <exclude name="Squiz.Commenting.FunctionComment.ScalarTypeHintMissing" />
    <exclude name="Squiz.Commenting.FunctionComment.SpacingAfterParamName" />
    <exclude name="Squiz.Commenting.FunctionComment.SpacingAfterParamType" />
    <exclude name="Squiz.Commenting.InlineComment.DocBlock" />
    <exclude name="Squiz.Commenting.LongConditionClosingComment" />
    <exclude name="Squiz.Commenting.VariableComment.IncorrectVarType" />
    <exclude name="Squiz.Commenting.VariableComment.TagNotAllowed" />
    <exclude name="Squiz.Commenting.VariableComment.VarOrder" />
    <exclude name="Squiz.ControlStructures.ControlSignature.SpaceAfterCloseBrace" />
    <exclude name="Squiz.ControlStructures.ElseIfDeclaration" />
    <exclude name="Squiz.ControlStructures.InlineIfDeclaration.NoBrackets" />
    <exclude name="Squiz.ControlStructures.SwitchDeclaration.BreakIndent" />
    <exclude name="Squiz.ControlStructures.SwitchDeclaration.DefaultNoBreak" />
    <exclude name="Squiz.ControlStructures.SwitchDeclaration.EmptyCase" />
    <exclude name="Squiz.ControlStructures.SwitchDeclaration.MissingDefault" />
    <exclude name="Squiz.ControlStructures.SwitchDeclaration.SpacingAfterCase" />
    <exclude name="Squiz.Files.FileExtension" />
    <exclude name="Squiz.Formatting.OperatorBracket.MissingBrackets" />
    <exclude name="Squiz.Functions.FunctionDeclarationArgumentSpacing.SpaceAfterEquals" />
    <exclude name="Squiz.Functions.FunctionDeclarationArgumentSpacing.SpaceBeforeEquals" />
    <exclude name="Squiz.Functions.GlobalFunction" />
    <exclude name="Squiz.Functions.MultiLineFunctionDeclaration.BraceOnSameLine" />
    <exclude name="Squiz.Functions.MultiLineFunctionDeclaration.SpaceAfterFunction" />
    <exclude name="Squiz.NamingConventions.ValidFunctionName.NotCamelCaps" />
    <exclude name="Squiz.NamingConventions.ValidFunctionName.ScopeNotCamelCaps" />
    <exclude name="Squiz.NamingConventions.ValidVariableName.MemberNotCamelCaps" />
    <exclude name="Squiz.NamingConventions.ValidVariableName.NotCamelCaps" />
    <exclude name="Squiz.NamingConventions.ValidVariableName.StringNotCamelCaps" />
    <exclude name="Squiz.Operators.ComparisonOperatorUsage.ImplicitTrue" />
    <exclude name="Squiz.Operators.ComparisonOperatorUsage.NotAllowed" />
    <exclude name="Squiz.Operators.IncrementDecrementUsage" />
    <exclude name="Squiz.PHP.DisallowBooleanStatement" />
    <exclude name="Squiz.PHP.DisallowComparisonAssignment" />
    <exclude name="Squiz.PHP.DisallowInlineIf" />
    <exclude name="Squiz.PHP.DisallowMultipleAssignments" />
    <exclude name="Squiz.PHP.DisallowSizeFunctionsInLoops" />
    <exclude name="Squiz.PHP.DiscouragedFunctions.Discouraged" />
    <exclude name="Squiz.PHP.EmbeddedPhp.Indent" />
    <exclude name="Squiz.PHP.EmbeddedPhp.OpenTagIndent" />
    <exclude name="Squiz.PHP.Eval" />
    <exclude name="Squiz.PHP.GlobalKeyword" />
    <exclude name="Squiz.PHP.Heredoc" />
    <exclude name="Squiz.Scope.MethodScope" />
    <exclude name="Squiz.Strings.ConcatenationSpacing" />
    <exclude name="Squiz.Strings.DoubleQuoteUsage.ContainsVar" />
    <exclude name="Squiz.WhiteSpace.ControlStructureSpacing.LineAfterClose" />
    <exclude name="Squiz.WhiteSpace.ControlStructureSpacing.NoLineAfterClose" />
    <exclude name="Squiz.WhiteSpace.FunctionClosingBraceSpace.SpacingBeforeClose" />
    <exclude name="Squiz.WhiteSpace.FunctionSpacing.After" />
    <exclude name="Squiz.WhiteSpace.FunctionSpacing.AfterLast" />
    <exclude name="Squiz.WhiteSpace.FunctionSpacing.Before" />
    <exclude name="Squiz.WhiteSpace.FunctionSpacing.BeforeFirst" />
    <exclude name="Squiz.WhiteSpace.ObjectOperatorSpacing.Before" />
  </rule>

  <!-- Exclude files/folders from certain sniffs. -->
  <rule ref="Squiz.Arrays.ArrayDeclaration.NoKeySpecified">
    <!-- Ignore array keys in transliteration files. -->
    <exclude-pattern>*/core/includes/transliteration/*</exclude-pattern>
  </rule>
  <rule ref="Zend.Files.ClosingTag.NotAllowed">
    <!-- Template files can end with a closing PHP tag. -->
    <exclude-pattern>*.tpl.php</exclude-pattern>
  </rule>
</ruleset>
